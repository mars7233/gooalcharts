<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>5_散点图</title>
    <script src="../build/gooalcharts.js"></script>
</head>

<body>

    <div>
        <h1>5 散点图</h1>
        <h1>5.1 散点图</h1>
        <button onclick="redrawScatter()">重画</button>
        <div id="scatter"></div>
        <h1>5.2 气泡图</h1>
        <button onclick="scattertSingleSelect()">单选</button>
        <button onclick="scatterMultiSelect()">多选</button>
        <button onclick="scatterSelectOff()">关</button>
        <button onclick="scatterRedraw()">重画</button>
        <button onclick="getElement()">获取legend元素</button>
        <div id="bubble"></div>
        <h1>5.3 x轴离散散点图</h1>
        <div id="discrete"></div>
    </div>

    <script>
        // ---------------------------------------------------------------------------------------
        // -------------------------------------- scatter-----------------------------------------
        // ---------------------------------------------------------------------------------------
        var scatteroption = {
            "id": "5",
            "type": "scatter",
            "data": [],
            "width": 1000,
            "titleBox": {
                "show": true,
                "position": "top",
                "title": "This is a Scatterchart",
                "editable": true

            },
            "axisBox": {
                "xAxis": {
                    // "minScale": -10,
                    // "maxScale": 1000
                },
                "yAxis": {
                    // "minScale": -100,
                    // "maxScale": 1000
                }
            },
            "legendBox": {
                "show": true,
                "title": "Scatter Legend",
                "icon": {
                    "x": 30,
                    "y": 30
                }
            },
            "dataBox": {
                "radius": 3,
                // "hoverRadius": 10
            }
        }
        var scatterData = randomData(100)
        function randomData(samples) {
            var fake = []
            for (i = 0; i < samples; i++) {
                var newKey = Math.floor(Math.random() * 300);
                var newValue = Math.floor(Math.random() * 300);
                var category = Math.floor(Math.random() * 5);
                var tempdata = { "category": category + 1231, "key": newKey, "value": newValue }
                fake.push(tempdata);
            }
            return fake;
        }

        scatteroption.data = scatterData;
        var satter = new gooal.scatterInit("#scatter", scatteroption);
        var scattertooltip = satter.addTooltip(scattertooltipConfig);
        function scattertooltipConfig(d) {
            scattertooltip.html("category: " + d.category + "</br>" + "key:" + d.key + "</br>" + "value: " + d.value)
        }

        function redrawScatter() {
            satter.redraw(1000)
        }

        // ---------------------------------------------------------------------------------------
        // -------------------------------------- bubble -----------------------------------------
        // ---------------------------------------------------------------------------------------

        // 气泡图
        var bubbleoption = {
            "id": "bubb",
            "type": "bubble",
            "data": [],
            "width": 800,
            "height": 300,
            "titleBox": {
                "show": true,
                "position": "top",
                "title": "This is a Bubblechart",
            },
            "axisBox": {
                "xAxis": {
                    "title": 233,
                }
            },
            "legendBox": {
                "show": true,
            },
            "dataBox": {
                "bubbleRadius": [5, 10],
            }
        }
        var bubbleData = randomBubbleData(20)
        function randomBubbleData(samples) {
            var fake = []
            for (i = 0; i < samples; i++) {
                var newKey = i + 1234;
                var newValue = Math.floor(Math.random() * 300 + 100);
                var category1 = Math.floor(Math.random() * 100);
                var category2 = Math.floor(Math.random() * 100);
                // category1 控制颜色   category2 控制半径
                var tempdata = { "category1": category1, "category2": category2, "key": newKey, "value": newValue }
                fake.push(tempdata);
            }
            return fake;
        }

        bubbleoption.data = bubbleData;
        var bubble = new gooal.scatterInit("#bubble", bubbleoption);
        var bubbletooltip = bubble.addTooltip(bubbletooltipConfig);
        function bubbletooltipConfig(d) {
            bubbletooltip.html("sizeCategory: " + d.category2 + "</br>" + "colorCategory: " + d.category1 + "</br>" + "key:" + d.key + "</br>" + "value: " + d.value)
        }

        bubble.addEvent("mouseover", function (d, i) {
            console.log(d)
        })

        // 添加单选/多选事件
        let selData = []
        function scattertSingleSelect() {
            bubble.selectOn("single", function (d) {
                console.log(d)
            })
        }
        function scatterMultiSelect() {
            bubble.selectOn("multiple", function (d) {
                console.log(d)
            })
        }
        function scatterSelectOff() {
            selData = bubble.selectOff()
            console.log(selData)
        }

        function showData() {
            console.log(selData)
        }

        function scatterRedraw() {
            debugger;
            bubble.redraw(800, bubble.getOptions())
        }

        let color = "#000000"
        // 改颜色
        function getElement() {
            bubble.getLegendItem(function (d, i) {
                bubble.changeColor(i, color)
            })
        }

        // ---------------------------------------------------------------------------------------
        // ----------------------------------discrete scatter-------------------------------------
        // ---------------------------------------------------------------------------------------
        var discreteOption = {
            "id": "discrete",
            "type": "scatter",
            "data": [],
            "width": 800,
            "titleBox": {
                "show": true,
                "position": "top",
                "title": "This is a Discrete Scatter"
            },
            "axisBox": {
                "xAxis": {
                    "type": "discrete"
                }
            },
            "legendBox": {
                "show": true,
            },
            "dataBox": {

            }
        }

        var discreteData = discRandomData(10)
        function discRandomData(samples) {
            var fake = []
            for (i = 0; i < samples; i++) {
                var newKey = Math.floor(Math.random() * 300);
                var newValue = Math.floor(Math.random() * 300);
                var category = Math.floor(Math.random() * 5);
                var tempdata = { "category": category, "key": newKey, "value": newValue }
                fake.push(tempdata);
            }
            return fake;
        }

        discreteOption.data = discreteData;
        var discrete = new gooal.scatterInit("#discrete", discreteOption);

        var disctooltip = discrete.addTooltip(discTooltipConfig);
        function discTooltipConfig(d) {
            disctooltip.html("key: " + d.key + "</br>" + "value: " + d.value)
        }

    </script>
</body>

</html>